{"version":3,"sources":["../src/graphql.ts"],"names":["graphql","req","user","header","authorization","dataloaders","graphiql","process","env","NODE_ENV","schema","context","formatError","message","locations","stack","console","log"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;;;;;AAEA,MAAMA,OAAO;AAAA,+BAAG,WAAOC,GAAP,EAAwB;AACtC,UAAM;AAAEC,MAAAA;AAAF,cAAiB,mBAAQD,GAAG,CAACE,MAAJ,CAAWC,aAAnB,CAAvB;AAEA,UAAMC,WAAW,GAAG,qCAApB;AAEA,WAAO;AACLC,MAAAA,QAAQ,EAAEC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAD9B;AAELC,MAAAA,MAAM,EAANA,cAFK;AAGLC,MAAAA,OAAO,EAAE;AACPT,QAAAA,IADO;AAEPD,QAAAA,GAFO;AAGPI,QAAAA;AAHO,OAHJ;AAQLO,MAAAA,WAAW,EAAE,CAAC;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,SAAX;AAAsBC,QAAAA;AAAtB,OAAD,KAAiD;AAC5DC,QAAAA,OAAO,CAACC,GAAR,CAAYJ,OAAZ;AACAG,QAAAA,OAAO,CAACC,GAAR,CAAYH,SAAZ;AACAE,QAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AAEA,eAAO;AACLF,UAAAA,OADK;AAELC,UAAAA,SAFK;AAGLC,UAAAA;AAHK,SAAP;AAKD;AAlBI,KAAP;AAoBD,GAzBY;;AAAA,kBAAPf,OAAO;AAAA;AAAA;AAAA,GAAb;;eA2BeA,O","sourcesContent":["import { Request } from \"koa\";\nimport { GraphQLError } from \"graphql\";\n\nimport { schema } from \"./graphql/schema\";\nimport { getUser } from \"./utils/auth\";\nimport { getDataloaders } from \"./modules/Loader/LoaderRegister\";\n\nconst graphql = async (req: Request) => {\n  const { user } = await getUser(req.header.authorization);\n\n  const dataloaders = getDataloaders();\n\n  return {\n    graphiql: process.env.NODE_ENV !== \"production\",\n    schema,\n    context: {\n      user,\n      req,\n      dataloaders,\n    },\n    formatError: ({ message, locations, stack }: GraphQLError) => {\n      console.log(message);\n      console.log(locations);\n      console.log(stack);\n\n      return {\n        message,\n        locations,\n        stack,\n      };\n    },\n  };\n};\n\nexport default graphql;\n"],"file":"graphql.js"}